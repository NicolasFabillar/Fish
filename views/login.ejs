<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" />
    <title>Login and Registration Form in HTML</title>
    <link rel="stylesheet" href="/css/login.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>
  <body class="background">

    <!-- Reminder Popup Modal -->
    <div id="myPopup" class="popup">
      <div class="popup-content">
        <div class="icon">
          <span class="close">&times;</span>
        </div>
        <h1>Reminder!</h1>
        <p>
          To access this feature, you must sign in first. Please log in to your
          account to continue. If you don't have an account, you can sign up
          easily by following the registration process.
        </p>
      </div>
    </div>

    <!-- Error Popup Modal -->
    <div id="errorPopup" class="error-popup">
      <div class="popup-content">
        <div class="icon">
          <span class="close" onclick="closeErrorPopup()">&times;</span>
        </div>
        <h1>Error!</h1>
        <p>Incorrect email or password. Please try again.</p>
      </div>
    </div>

    <div id="successPopup" class="error-popup">
      <div class="popup-content">
        <div class="icon">
          <span class="close" onclick="closeSuccessPopup()">&times;</span>
        </div>
        <h1>Success</h1>
        <p>You are now logged in.</p>
      </div>
    </div>

    <div class="wrapper">
      <div class="title-text" style="margin-left: 85px">
        <a href="/"><img src="/images/logo1.png" alt="" style="width: 200px" /></a>
      </div>
      <div class="form-container">
        <div class="form-inner">
          <form
            action="/auth/api/login/"
            method="POST"
            class="login"
            id="loginForm"
          >
            <input
              type="hidden"
              name="fishID"
              value="<%= typeof fishID !== 'undefined' ? fishID : '' %>"
            />
            <input
              type="hidden"
              name="sellerPage"
              value="<%= typeof sellerPage !== 'undefined' ? sellerPage : '' %>"
            />
            <div class="field">
              <input
                type="text"
                placeholder="Email Address"
                id="email"
                name="email"
                required
              />
            </div>
            <div class="field">
              <input
                type="password"
                placeholder="Password"
                id="password"
                name="password"
                required
              />
            </div>
            <div class="pass-link">
              <a href="#">Forgot password?</a>
            </div>
            <div class="field btn">
              <div class="btn-layer"></div>
              <input type="submit" value="Login" />
            </div>
            <div class="signup-link">
              Not a member? <a href="/signup">Signup now</a>
            </div>
          </form>

          <!-- Ensure this form is intended -->
          <form action="#" class="login">
            <div class="field">
              <input type="text" placeholder="Email Address" required />
            </div>
            <div class="field">
              <input type="password" placeholder="Password" required />
            </div>
            <div class="pass-link">
              <a href="#">Forgot password?</a>
            </div>
            <div class="field btn">
              <div class="btn-layer"></div>
              <input type="submit" value="Login" />
            </div>
          </form>
        </div>
      </div>
    </div>

    <script>
      // JavaScript for Popup functionality
      var popup = document.getElementById("myPopup");
      var btn = document.getElementById("popupBtn");
      var span = document.getElementsByClassName("close")[0];

      span.onclick = function () {
        popup.style.display = "none";
      };

      window.onclick = function (event) {
        if (event.target == popup) {
          popup.style.display = "none";
        }
      };

      // Error Popup
      var errorPopup = document.getElementById("errorPopup");
      var successPopup = document.getElementById("successPopup");

      // Show error popup function
      function showErrorPopup() {
        errorPopup.style.display = "block";
      }

      function showSuccessPopup() {
        successPopup.style.display = "block";
      }

      function closeSuccessPopup() {
        successPopup.style.display = "none";
      }

      // Close error popup function
      function closeErrorPopup() {
        errorPopup.style.display = "none";
      }

      // Example: Check login validation
      document.addEventListener('DOMContentLoaded', (event) => {
            const message = '<%= message %>';
            if (message === 'Wrong Password') {
                showErrorPopup();
                event.preventDefault(); // Prevent form submission if necessary
            }
            if (message === 'Logged in Successfully') {
                showSuccessPopup();
                event.preventDefault(); // Prevent form submission if necessary
            }
            if (message === 'Login First') {
                popup.style.display = "block";
            }
        });
    </script>
  </body>
</html>
